<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projekt Details - Dren Sefa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: #ffffff; font-family: 'Inter', sans-serif; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        .gold-text { color: #D4AF37; }
        .loader { border-top-color: #D4AF37; animation: spinner 1.5s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .sticky-sidebar {
            position: sticky;
            top: 100px;
        }

        .image-placeholder {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.75rem;
            text-align: center;
            padding: 1rem;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <nav class="fixed w-full z-50 bg-black/90 backdrop-blur-md border-b border-white/10">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <a href="index.html" class="text-2xl font-bold tracking-tighter">DREN SEFA</a>
            <a href="projects.html" class="text-sm tracking-widest hover:text-[#D4AF37] transition-colors" id="back-link">ZURÜCK</a>
        </div>
    </nav>

    <div id="project-container" class="flex-grow pt-20 min-h-screen relative">
        <div class="absolute inset-0 flex items-center justify-center">
            <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"></div>
        </div>
    </div>

    <footer class="border-t border-white/10 py-12 bg-black">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-gray-500 text-sm" id="footer-text">Luxury Real Estate Dubai</p>
        </div>
    </footer>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        let lang = urlParams.get('lang') || localStorage.getItem('language_selected') || 'de';

        const translations = {
            en: {
                backButton: 'BACK',
                detailsHeading: 'Details & Highlights',
                interestHeading: 'Interested?',
                whatsappButton: 'WhatsApp Inquiry',
                brochureButton: 'Download Brochure',
                contactText: 'Direct Contact: +971 58 526 1697',
                footerText: 'Luxury Real Estate Dubai',
                pricePrefix: 'From',
                notFound: 'Project not found.',
                error: 'Error loading data.',
                developer: 'Developer',
                status: 'Status',
                handover: 'Handover',
                offPlan: 'Off Plan'
            },
            de: {
                backButton: 'ZURÜCK',
                detailsHeading: 'Details & Highlights',
                interestHeading: 'Interesse geweckt?',
                whatsappButton: 'WhatsApp Anfrage',
                brochureButton: 'Broschüre Herunterladen',
                contactText: 'Direktkontakt: +971 58 526 1697',
                footerText: 'Luxury Real Estate Dubai',
                pricePrefix: 'Ab',
                notFound: 'Projekt nicht gefunden.',
                error: 'Fehler beim Laden.',
                developer: 'Entwickler',
                status: 'Status',
                handover: 'Übergabe',
                offPlan: 'Off Plan'
            },
            sq: {
                backButton: 'KTHEHU',
                detailsHeading: 'Detaje & Veçori',
                interestHeading: 'Të interesuar?',
                whatsappButton: 'Kërkesë WhatsApp',
                brochureButton: 'Shkarko Broshurën',
                contactText: 'Kontakt Direkt: +971 58 526 1697',
                footerText: 'Pasuri Luksoze Dubai',
                pricePrefix: 'Nga',
                notFound: 'Projekti nuk u gjet.',
                error: 'Gabim në ngarkimin e të dhënave.',
                developer: 'Zhvilluesi',
                status: 'Statusi',
                handover: 'Dorëzimi',
                offPlan: 'Off Plan'
            }
        };

        const t = translations[lang];

        document.getElementById('back-link').textContent = t.backButton;
        document.getElementById('footer-text').textContent = t.footerText;
        document.documentElement.lang = lang;

        async function loadProjectDetails() {
            const id = urlParams.get('id');

            if (!id) {
                window.location.href = 'index.html';
                return;
            }

            try {
                const response = await fetch('projects.json?' + new Date().getTime());
                const projects = await response.json();
                const project = projects.find(p => p.id == id);

                if (project) {
                    renderProject(project);
                } else {
                    document.getElementById('project-container').innerHTML =
                        `<div class="text-center pt-40 text-xl">${t.notFound}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('project-container').innerHTML =
                    `<div class="text-center pt-40 text-red-500">${t.error}</div>`;
            }
        }

        function renderImageOrPlaceholder(imageUrl, altText, cssClasses = '') {
            if (imageUrl && imageUrl.includes('INSERT_')) {
                return `<div class="${cssClasses} image-placeholder">
                    <span>Bitte Bild-URL<br>in JSON einfügen</span>
                </div>`;
            }
            return `<img src="${imageUrl}" alt="${altText}" class="${cssClasses} w-full h-full object-cover">`;
        }

        function renderProject(project) {
            const container = document.getElementById('project-container');

            const title = lang === 'de' && project.title_de ? project.title_de :
                         lang === 'sq' && project.title_sq ? project.title_sq :
                         project.title;

            const location = lang === 'de' && project.location_de ? project.location_de :
                            lang === 'sq' && project.location_sq ? project.location_sq :
                            project.location;

            const description = lang === 'de' && project.description_de ? project.description_de :
                               lang === 'sq' && project.description_sq ? project.description_sq :
                               project.description_en || project.description || '';

            // Format price with thousands separator
            const priceVal = typeof project.price === 'string' ? parseInt(project.price) : project.price;
            const priceAED = priceVal.toLocaleString('de-DE');
            const priceEUR = Math.round(priceVal * 0.25).toLocaleString('de-DE');

            // Images
            const images = project.images || [project.image, project.image, project.image, project.image, project.image];
            const mainImage = images[0];
            const smallImages = images.slice(1, 5);

            container.innerHTML = `
                <!-- Bento Grid Hero -->
                <div class="relative w-full bg-[#050505] pt-8 pb-16">
                    <div class="max-w-7xl mx-auto px-6">
                        <!-- Breadcrumb -->
                        <div class="mb-6">
                            <span class="text-[#D4AF37] tracking-widest text-xs uppercase">${location}</span>
                        </div>

                        <!-- Title -->
                        <h1 class="text-4xl md:text-5xl font-bold mb-8">${title}</h1>

                        <!-- Image Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                            <!-- Main Image (Left) -->
                            <div class="h-[400px] md:h-[600px] overflow-hidden rounded-lg">
                                ${renderImageOrPlaceholder(mainImage, title, '')}
                            </div>

                            <!-- Small Images Grid (Right) -->
                            <div class="grid grid-cols-2 gap-4">
                                ${smallImages.map((img, idx) => `
                                    <div class="h-[192px] md:h-[292px] overflow-hidden rounded-lg">
                                        ${renderImageOrPlaceholder(img, `${title} ${idx + 2}`, '')}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Section with Sticky Sidebar -->
                <div class="max-w-7xl mx-auto px-6 py-16">
                    <div class="grid md:grid-cols-3 gap-12">
                        <!-- Main Content (Left - 2 columns) -->
                        <div class="md:col-span-2 space-y-8">
                            <div>
                                <h3 class="text-2xl font-bold mb-6 gold-text">${t.detailsHeading}</h3>
                                <div class="prose prose-invert text-gray-300 leading-relaxed text-lg">
                                    ${description}
                                </div>
                            </div>
                        </div>

                        <!-- Sticky Sidebar (Right - 1 column) -->
                        <div class="md:col-span-1">
                            <div class="sticky-sidebar bg-white/5 p-8 rounded-lg border border-white/10">
                                <!-- Price -->
                                <div class="mb-6 pb-6 border-b border-white/10">
                                    <div class="text-sm text-gray-500 mb-2">${t.pricePrefix}</div>
                                    <div class="text-3xl font-bold text-white mb-1">${priceAED} AED</div>
                                    <div class="text-gray-400 text-sm">~ ${priceEUR} €</div>
                                </div>

                                <!-- Info Grid -->
                                <div class="space-y-4 mb-6 pb-6 border-b border-white/10">
                                    <div>
                                        <div class="text-xs text-gray-500 uppercase tracking-wider mb-1">${t.developer}</div>
                                        <div class="text-white font-medium">${project.developer || 'N/A'}</div>
                                    </div>
                                    <div>
                                        <div class="text-xs text-gray-500 uppercase tracking-wider mb-1">${t.status}</div>
                                        <div class="text-white font-medium">${project.status || t.offPlan}</div>
                                    </div>
                                    <div>
                                        <div class="text-xs text-gray-500 uppercase tracking-wider mb-1">${t.handover}</div>
                                        <div class="text-white font-medium">${project.handover || 'TBA'}</div>
                                    </div>
                                </div>

                                <!-- CTA Buttons -->
                                <div class="space-y-3">
                                    <a href="https://wa.me/971585261697?text=Hi Dren, ${lang === 'de' ? 'ich interessiere mich für' : lang === 'sq' ? 'jam i interesuar për' : 'I am interested in'} ${title}"
                                       target="_blank"
                                       class="block w-full bg-[#25D366] hover:bg-[#128C7E] text-white text-center py-4 rounded font-bold transition-all shadow-lg hover:shadow-green-900/20 text-sm uppercase tracking-wider">
                                        ${t.whatsappButton}
                                    </a>
                                    <button onclick="alert('Broschüre wird in Kürze verfügbar sein!')"
                                       class="block w-full bg-white/10 hover:bg-white/20 text-white text-center py-4 rounded font-medium transition-all border border-white/20 hover:border-white/30 text-sm uppercase tracking-wider">
                                        ${t.brochureButton}
                                    </button>
                                </div>

                                <p class="text-center text-xs text-gray-500 mt-6">${t.contactText}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        loadProjectDetails();
    </script>
</body>
</html>
